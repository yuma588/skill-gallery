# ä»£ç å¯¹æ¯”ï¼špdf-skillsç¤ºä¾‹ vs å®é™…è„šæœ¬

## ğŸ“š pdf-skillsåŸå§‹ä»£ç ï¼ˆSKILL.md ç¬¬102-119è¡Œï¼‰

```python
import pandas as pd

with pdfplumber.open("document.pdf") as pdf:
    all_tables = []
    for page in pdf.pages:
        tables = page.extract_tables()
        for table in tables:
            if table:  # Check if table is not empty
                df = pd.DataFrame(table[1:], columns=table[0])
                all_tables.append(df)

# Combine all tables
if all_tables:
    combined_df = pd.concat(all_tables, ignore_index=True)
    combined_df.to_excel("extracted_tables.xlsx", index=False)
```

## ğŸ”§ æˆ‘çš„ä¿®æ”¹ï¼ˆextract_tables_from_skill.pyï¼‰

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import pdfplumber
import pandas as pd

# PDFæ–‡ä»¶è·¯å¾„
pdf_path = "d:/skill gallery/chinese_document.pdf"

# æå–æ‰€æœ‰è¡¨æ ¼
all_tables = []

print(f"æ­£åœ¨å¤„ç†PDFæ–‡ä»¶: {pdf_path}")
print("-" * 60)

with pdfplumber.open(pdf_path) as pdf:
    print(f"æ€»é¡µæ•°: {len(pdf.pages)}\n")
    
    for i, page in enumerate(pdf.pages, 1):
        tables = page.extract_tables()
        
        if tables:
            print(f"ç¬¬ {i} é¡µ: å‘ç° {len(tables)} ä¸ªè¡¨æ ¼")
            
            for j, table in enumerate(tables, 1):
                if table:
                    if len(table) > 1:
                        df = pd.DataFrame(table[1:], columns=table[0])
                    else:
                        df = pd.DataFrame(table)
                    
                    all_tables.append(df)
                    print(f"  - è¡¨æ ¼ {j}: {df.shape[0]} è¡Œ Ã— {df.shape[1]} åˆ—")
        else:
            print(f"ç¬¬ {i} é¡µ: æ— è¡¨æ ¼")

# åˆå¹¶æ‰€æœ‰è¡¨æ ¼
if all_tables:
    print("\n" + "=" * 60)
    print("å¼€å§‹å¯¼å‡ºè¡¨æ ¼æ•°æ®...")
    print("=" * 60)
    
    combined_df = pd.concat(all_tables, ignore_index=True)
    
    # å¯¼å‡ºåˆ°Excel
    excel_output = "chinese_document_tables_skill.xlsx"
    combined_df.to_excel(excel_output, index=False)
    print(f"âœ… Excelæ–‡ä»¶å·²å¯¼å‡º: {excel_output}")
    
    # å¯¼å‡ºä¸ºCSV
    csv_output = "chinese_document_tables_skill.csv"
    combined_df.to_csv(csv_output, index=False, encoding='utf-8-sig')
    print(f"âœ… CSVæ–‡ä»¶å·²å¯¼å‡º: {csv_output}")
    
    print(f"\næ€»è®¡: {len(all_tables)} ä¸ªè¡¨æ ¼ï¼Œ{len(combined_df)} è¡Œæ•°æ®")
else:
    print("\næœªæ£€æµ‹åˆ°ä»»ä½•è¡¨æ ¼")
```

## ğŸ“Š ä¿®æ”¹è¯´æ˜

| ä¿®æ”¹ç‚¹ | pdf-skillsåŸå§‹ | æˆ‘çš„ä¿®æ”¹ | åŸå›  |
|:---|:---|:---|:---|
| **æ–‡ä»¶è·¯å¾„** | `"document.pdf"` | `"d:/skill gallery/chinese_document.pdf"` | æŒ‡å®šå®é™…æ–‡ä»¶ |
| **å¯¼å…¥åº“** | åªå¯¼å…¥`pandas` | å¯¼å…¥`pdfplumber`å’Œ`pandas` | éœ€è¦ä½¿ç”¨pdfplumber |
| **è¿›åº¦æ˜¾ç¤º** | æ—  | æ·»åŠ è¯¦ç»†æ—¥å¿— | æ–¹ä¾¿ç”¨æˆ·äº†è§£è¿›åº¦ |
| **å¼‚å¸¸å¤„ç†** | æ—  | æ£€æŸ¥`len(table) > 1` | å¤„ç†å•è¡Œè¡¨æ ¼ |
| **è¾“å‡ºæ–‡ä»¶** | `extracted_tables.xlsx` | `chinese_document_tables_skill.xlsx` | æ›´æ˜ç¡®çš„æ–‡ä»¶å |
| **å¯¼å‡ºæ ¼å¼** | ä»…Excel | Excel + CSV | æä¾›å¤šç§æ ¼å¼ |
| **ç¼–ç è®¾ç½®** | æ—  | `encoding='utf-8-sig'` | ç¡®ä¿ä¸­æ–‡æ­£å¸¸æ˜¾ç¤º |

## âœ… æ ¸å¿ƒé€»è¾‘ä¿æŒä¸€è‡´

ä»¥ä¸‹æ ¸å¿ƒé€»è¾‘**å®Œå…¨ç›¸åŒ**ï¼š

```python
# 1. æå–è¡¨æ ¼
tables = page.extract_tables()

# 2. è½¬æ¢ä¸ºDataFrame
df = pd.DataFrame(table[1:], columns=table[0])

# 3. æ”¶é›†æ‰€æœ‰è¡¨æ ¼
all_tables.append(df)

# 4. åˆå¹¶è¡¨æ ¼
combined_df = pd.concat(all_tables, ignore_index=True)

# 5. å¯¼å‡ºExcel
combined_df.to_excel("output.xlsx", index=False)
```

## ğŸ¯ ç»“è®º

è¿™ä¸ªè„šæœ¬ï¼š
- âœ… **å®Œå…¨åŸºäºpdf-skillsç¤ºä¾‹**
- âœ… **ä¿æŒäº†æ ¸å¿ƒé€»è¾‘ä¸å˜**
- âœ… **æ·»åŠ äº†å¿…è¦çš„å®ç”¨åŠŸèƒ½**
- âœ… **é€‚é…äº†å®é™…æ–‡ä»¶å’Œç¯å¢ƒ**

å®ƒå°†pdf-skillsä¸­çš„ç¤ºä¾‹ä»£ç è½¬åŒ–ä¸ºä¸€ä¸ª**å¯ç›´æ¥è¿è¡Œçš„å·¥å…·**ï¼ŒåŒæ—¶ä¿æŒäº†ä»£ç é£æ ¼çš„ä¸€è‡´æ€§ã€‚
